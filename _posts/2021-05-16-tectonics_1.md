---
layout: post
title: "Plate Tectonics 1"
tagline: "TODO: initial state"
tags: [yggdrasill]
excerpt_separator: <!--more-->
---

TOOD: intro

<!--more-->

TODO: `generate_sphere` recap
- Fibonacci sphere + small random offsets (1/2 step-size to avoid collisions) => even distribution, without obvious poles, no obvious patterns in vertices or triangulation 
- QuickHull (might later be replaced, but currently fast enough) => delaunay triangulation

TODO: `generate_plates`
- Pick N random starting points (retry if position is already taken)
    - Type: First M are ocean, rest are continental plates
    - Id: incrementing counter starting from 1 (0=no plate)
    - Velocity: Random Angle and Speed => Generate 3D-Vector, tangential to surface normal (normalized position of vertex)
    - Elevation/Creation-Time: Random in given range based on type
- Flood Fill
    1. For each vertex that we just assigned to a plate: Add neighbors to the same plate
        - Id/Type are copied
        - Velocity is modified to be tangential to surface normal
```cpp

auto p           = (*positions)[n];
auto np          = normalized(p + velocity * 100.f) * length(p);
velocities[n]    = (np - p) / 100.f;
```
        - Increase/decrease creation time slightly based on type: `type == pt_oceanic ? created_time * 0.9f : created_time * 1.1f;`
        - Copy elevation, but disturb it slightly for continental plates
    2. Randomly shuffle the list of vertices that were modified in this iteration and goto step 1, until no vertices have been modified

{% include video.html url="/assets/images/sphere_plates.webm" description="TODO" %}

{% include video.html url="/assets/images/sphere_plate_directions.webm" description="TODO" %}

# Conclusion
Next => simulation

